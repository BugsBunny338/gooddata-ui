<html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Global Filters Example · GoodData UI SDK</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Global Filters Example · GoodData UI SDK"/><meta property="og:type" content="website"/><meta property="og:url" content="https://gooddata.github.io/gdc-ui-sdk-doc/index.html"/><meta property="og:description" content="Here is how you can combine several components to apply a dynamic attribute filter to multiple display and SDK components."/><link rel="shortcut icon" href="/gdc-ui-sdk-doc/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/gdc-ui-sdk-doc/css/main.css"/></head><body class="sideNavVisible doc separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/gdc-ui-sdk-doc/"><img class="logo" src="/gdc-ui-sdk-doc/img/gooddata_white.svg"/><h2 class="headerTitle">GoodData UI SDK</h2></a><a href="/gdc-ui-sdk-doc/versions.html"><h3>4.1.1</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/gdc-ui-sdk-doc/docs/getting_started.html" target="_self">Docs</a></li><li class=""><a href="/gdc-ui-sdk-doc/docs/examples.html" target="_self">Examples</a></li><li class=""><a href="/gdc-ui-sdk-doc/docs/trouble_shooting.html" target="_self">FAQ</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1>Global Filters Example</h1></header><article><div><span><p>Here is how you can combine several components to apply a dynamic attribute filter to multiple display and SDK components.</p>
<p>The AttributeElements component loads values of the Employee Name attribute. When you click an attribute value (employee) in the left pane, the KPIs, pie chart and bar chart are filtered by the selected attribute value (employee). In addition, employee information is passed into the EmployeeCard component that renders static data mixed with external data.</p>
<p><img src="/gdc-ui-sdk-doc/docs/assets/movie-speed.gif" alt="Global Filters"></p>
<p>The code which runs the sample:</p>
<pre><code class="hljs css javascript"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { PropTypes } <span class="hljs-keyword">from</span> <span class="hljs-string">'prop-types'</span>;
<span class="hljs-keyword">import</span> { AttributeElements, AfmComponents, Kpi } <span class="hljs-keyword">from</span> <span class="hljs-string">'@gooddata/react-components'</span>;
<span class="hljs-keyword">import</span> { SidebarItem } <span class="hljs-keyword">from</span> <span class="hljs-string">'../components/utils/SidebarItem'</span>;
<span class="hljs-keyword">import</span> { EmployeeCard } <span class="hljs-keyword">from</span> <span class="hljs-string">'../components/GlobalFiltersComponents/EmployeeCard'</span>;
<span class="hljs-keyword">import</span> { KpiMetricBox } <span class="hljs-keyword">from</span> <span class="hljs-string">'../components/GlobalFiltersComponents/KpiMetricBox'</span>;
<span class="hljs-keyword">import</span> {
    projectId,
    employeeNameIdentifier,
    averageDailyTotalSales,
    averageCheckSizeByServer,
    menuItemNameAttributeDFIdentifier,
    menuCategoryAttributeDFIdentifier
} <span class="hljs-keyword">from</span> <span class="hljs-string">'../utils/fixtures'</span>;
<span class="hljs-keyword">import</span> { Layout } <span class="hljs-keyword">from</span> <span class="hljs-string">'../components/utils/Layout'</span>;
<span class="hljs-keyword">import</span> { Loading } <span class="hljs-keyword">from</span> <span class="hljs-string">'../components/utils/Loading'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-built_in">Error</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../components/utils/Error'</span>;

<span class="hljs-keyword">const</span> { BarChart, PieChart } = AfmComponents;

<span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EmployeeProfile</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
    <span class="hljs-keyword">static</span> propTypes = {
        <span class="hljs-attr">validElements</span>: PropTypes.object.isRequired
    };

    <span class="hljs-keyword">constructor</span>(props) {
        <span class="hljs-keyword">super</span>(props);

        <span class="hljs-keyword">this</span>.state = {
            <span class="hljs-attr">selectedEmployeeUri</span>: props.validElements.items[<span class="hljs-number">0</span>].element.uri
        };

        <span class="hljs-keyword">this</span>.selectEmployee = <span class="hljs-keyword">this</span>.selectEmployee.bind(<span class="hljs-keyword">this</span>);
        <span class="hljs-keyword">this</span>.setDefaultSelection = <span class="hljs-keyword">this</span>.setDefaultSelection.bind(<span class="hljs-keyword">this</span>);
    }

    componentWillReceiveProps(nextProps) {
        <span class="hljs-keyword">if</span> (nextProps.validElements !== <span class="hljs-keyword">this</span>.props.validElements) {
            <span class="hljs-keyword">this</span>.setDefaultSelection(nextProps);
        }
    }

    setDefaultSelection(props) {
        <span class="hljs-keyword">this</span>.setState({
            <span class="hljs-attr">selectedEmployeeUri</span>: props.validElements.items[<span class="hljs-number">0</span>].element.uri
        });
    }

    selectEmployee(uri) {
        <span class="hljs-keyword">this</span>.setState({
            <span class="hljs-attr">selectedEmployeeUri</span>: uri
        });
    }

    render() {
        <span class="hljs-keyword">const</span> { selectedEmployeeUri } = <span class="hljs-keyword">this</span>.state;
        <span class="hljs-keyword">const</span> { validElements } = <span class="hljs-keyword">this</span>.props;

        <span class="hljs-keyword">const</span> sidebar = (
            &lt;div&gt;
                &lt;style jsx&gt;
                    {`
                        ul {
                            list-style-type: none;
                            padding: 0;
                            margin: 0 0 20px 0;
                        }
                    `}
                &lt;/style&gt;
                &lt;ul&gt;
                    {validElements ? validElements.items.map(item =&gt; (
                        &lt;SidebarItem
                            key={item.element.uri}
                            label={item.element.title}
                            id={item.element.uri}
                            isSelected={selectedEmployeeUri === item.element.uri}
                            onClick={this.selectEmployee}
                        /&gt;
                    )) : null}
                &lt;/ul&gt;
            &lt;/div&gt;
        );

        const employeeFilter = {
            positiveAttributeFilter: {
                displayForm: {
                    identifier: employeeNameIdentifier
                },
                in: [selectedEmployeeUri]
            }
        };
        const chartAfm = {
            measures: [
                {
                    localIdentifier: 'm1',
                    definition: {
                        measure: {
                            item: {
                                identifier: averageDailyTotalSales
                            }
                        }
                    },
                    alias: '$ Avg Daily Total Sales'
                }
            ],
            filters: [employeeFilter]
        };
        const selectedEmployee = validElements.items.find(item =&gt; item.element.uri === selectedEmployeeUri).element;
        const employeeName = selectedEmployee.title;

        return (
            &lt;div className="layout-wrapper"&gt;
                {/* language=CSS */}
                &lt;style jsx&gt;{`
                    .layout-wrapper {
                        display: flex;
                        flex: 1 0 auto;
                    }
                    h2 {
                        margin-top: 0;
                        border-bottom: 2px solid #14b2e2;
                        padding-bottom: 10px;
                        margin-bottom: 40px;
                    }
                    .details {
                        display: grid;
                        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
                        grid-column-gap: 20px;
                        grid-row-gap: 40px;
                    }

                    .kpis {
                        margin: -20px;
                        display: flex;
                        flex-wrap: wrap;
                        justify-content: space-between;
                        align-items: flex-start;
                    }

                    .bar-chart-block, .pie-chart-block {
                        display: flex;
                        flex-direction: column;
                    }

                    .bar-chart, .pie-chart {
                        flex: 1 0 400px;
                        height: 400px;
                    }
                `}&lt;/style&gt;
                &lt;Layout sidebar={sidebar} &gt;
                    &lt;div&gt;
                        &lt;h2&gt;Employee overview&lt;/h2&gt;
                        &lt;div className="details"&gt;
                            &lt;div&gt;
                                &lt;EmployeeCard uri={selectedEmployee.uri} name={employeeName} /&gt;
                            &lt;/div&gt;
                            &lt;div className="kpis"&gt;
                                &lt;KpiMetricBox title="Daily sales"&gt;
                                    &lt;Kpi
                                        filters={[employeeFilter]}
                                        measure={averageDailyTotalSales}
                                        projectId={projectId}
                                        format="$#,##0"
                                        LoadingComponent={
                                            (...otherProps) =&gt; &lt;Loading inline height={20} {...otherProps} /&gt;
                                        }
                                        ErrorComponent={Error}
                                    /&gt;
                                &lt;/KpiMetricBox&gt;

                                &lt;KpiMetricBox title="Average check amount"&gt;
                                    &lt;Kpi
                                        filters={[employeeFilter]}
                                        measure={averageCheckSizeByServer}
                                        projectId={projectId}
                                        format="$#,##0"
                                        LoadingComponent={
                                            (...otherProps) =&gt; &lt;Loading inline height={20} {...otherProps} /&gt;
                                        }
                                        ErrorComponent={Error}
                                    /&gt;
                                &lt;/KpiMetricBox&gt;
                            &lt;/div&gt;
                            &lt;div className="pie-chart-block" &gt;
                                &lt;h2&gt;Average daily total sales by menu category&lt;/h2&gt;
                                &lt;div className="pie-chart"&gt;
                                    &lt;PieChart
                                        afm={{
                                            ...chartAfm,
                                            attributes: [
                                                {
                                                    localIdentifier: 'a1',
                                                    displayForm: {
                                                        identifier: menuCategoryAttributeDFIdentifier
                                                    }
                                                }
                                            ]
                                        }}
                                        projectId={projectId}
                                        LoadingComponent={Loading}
                                        ErrorComponent={Error}
                                        config={{ legend: { position: 'bottom' } }}
                                    /&gt;
                                &lt;/div&gt;
                            &lt;/div&gt;
                            &lt;div className="bar-chart-block"&gt;
                                &lt;h2&gt;Average daily total sales by menu item&lt;/h2&gt;
                                &lt;div className="bar-chart"&gt;
                                    &lt;BarChart
                                        afm={{
                                            ...chartAfm,
                                            attributes: [
                                                {
                                                    localIdentifier: 'a1',
                                                    displayForm: {
                                                        identifier: menuItemNameAttributeDFIdentifier
                                                    },
                                                    alias: 'Employee name'
                                                }
                                            ]
                                        }}
                                        projectId={projectId}
                                        LoadingComponent={Loading}
                                        ErrorComponent={Error}
                                    /&gt;
                                &lt;/div&gt;
                            &lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/Layout&gt;
            &lt;/div&gt;
        );
    }
}

export const GlobalFiltersExample = () =&gt; (
    &lt;AttributeElements identifier={employeeNameIdentifier} projectId={projectId} options={{ limit: 20 }}&gt;
        {({ validElements, error, isLoading }) =&gt; {
            if (error) {
                return &lt;Error error={{ status: '400', message: error }} /&gt;;
            }
            if (isLoading) {
                return (
                    &lt;div style={{ flex: '1 0 auto', display: 'flex', flexDirection: 'column', justifyContent: 'center' }} &gt;
                        &lt;Loading speed={2} color="tomato" height="100px" /&gt;
                    &lt;/div&gt;
                );
            }
            return &lt;EmployeeProfile validElements={validElements} /&gt;;
        }}
    &lt;/AttributeElements&gt;
);

export default GlobalFiltersExample;
</code></pre>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"></nav></div><footer class="nav-footer" id="footer"><section class="sitemap" style="text-align:center;"><a href="/gdc-ui-sdk-doc/" class="nav-home"><img src="/gdc-ui-sdk-doc/img/gooddata_white.svg" alt="GoodData UI SDK" width="66" height="58"/></a><ul><li><a href="/gdc-ui-sdk-doc/docs/getting_started.html">Docs</a></li><li><a href="/gdc-ui-sdk-doc/docs/examples.html">Examples</a></li><li><a href="/gdc-ui-sdk-doc/docs/trouble_shooting.html">FAQ</a></li></ul></section><section class="copyright">Copyright © 2007–2018 GoodData Corporation. All Rights Reserved</section></footer></div></body></html>